<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Patients List</title>
  <link rel="stylesheet" th:href="@{/css/styles.css}" />
  <script>
    function toggleSelectAll(source) {
      const checkboxes = document.querySelectorAll('input[name="patientIds"]');
      checkboxes.forEach(cb => cb.checked = source.checked);
    }
  </script>
</head>
<body>
<div class="container" style="position: relative">
  <a
          href="javascript:history.back()"
          class="back-arrow"
          title="Back"
          aria-label="Back"
          style="display: inline-block"
  >&#8592;</a>
  <h1>Patient List</h1>

  <!-- Search by Mobile Number -->
  <div class="search-container">
    <h3>Search by Mobile Number</h3>
    <form th:action="@{/patients/search}" method="get">
      <input
              type="text"
              name="mobile"
              placeholder="Enter mobile number"
              required
              pattern="[0-9]{10}"
              maxlength="10" />
      <button type="submit" class="btn search-btn">Search</button>
    </form>
  </div>

  <a th:href="@{/patients/create}" class="btn create-btn">Add New Patient</a>

  <form th:action="@{/patients/deleteSelected}" method="post">
    <table>
      <thead>
      <tr>
        <th><input type="checkbox" onclick="toggleSelectAll(this)"> All</th>
        <th>ID</th>
        <th>Name</th>
        <th>Mobile</th>
        <th>Gender</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>

      <tr th:if="${#lists.isEmpty(patients)}">
        <td colspan="9">No patients found.</td>
      </tr>

      <tr th:each="patient : ${patients}">
        <td>
          <input type="checkbox" name="patientIds" th:value="${patient.id}">
        </td>
        <td th:text="${patient.id}">1</td>
        <td>
          <a th:href="@{/patients/{id}(id=${patient.id})}"
             th:text="${patient.name}" class="link"></a>
        </td>
        <td th:text="${patient.mobile}">9876543210</td>
        <td th:text="${patient.gender}">Male</td>
<!--        <td th:text="${patient.bloodGroup}">O_POSITIVE</td>-->
        <td>
          <a
                  th:href="@{/patients/edit/{id}(id=${patient.id})}"
                  class="btn edit-btn"
          >Edit</a>
          <a
                  th:href="@{/patients/delete/{id}(id=${patient.id})}"
                  class="btn delete-btn"
                  onclick="return confirm('Are you sure you want to delete this patient?');"
          >Delete</a>
        </td>
      </tr>
      </tbody>
    </table>

    <button
            type="submit"
            class="btn delete-btn"
            onclick="return confirm('Are you sure you want to delete selected patients?');">
      Delete Selected
    </button>
  </form>
</div>
</body>
</html>
